#!/usr/bin/env python3

from base64 import b64decode as b64d
from requests import get, post
from pwn import log

URL = "https://timetravel.ctf.prgy.in"
TIME = "https://time.ctf.prgy.in/timestamp"

def validate(token, signature, timestamp, timeserver=TIME):
	return post(URL + "/validate", json={
		"token": token,
		"signature": signature,
		"timestamp": timestamp,
		"timeserver": timeserver,
	}).json()


def main():
	jwt = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0aW1lc3RhbXAiOiIxNzM5MDU5MDY0Iiwic2lnbmF0dXJlIjoiNTQ5OWFjYjU5ZDE2YzFjYjg2OTAwNWMzYzcyZDM0NmFkZTFhMzEwZjk2NWFjOTQxOGJlNDA2ZDg1NjE0MjZjYTVlMzI3YjZlMGExOTUwODAzMjc5ZTBmYWUxMDEyYTE1ZWFhYWJmMWZkNDg4NTY1ZWFmZmE0NDdlMDgzNmE3ZDYiLCJ0aW1lc2VydmVyIjoiaHR0cHM6Ly90aW1lLmN0Zi5wcmd5LmluIiwiZXhwIjoiMTczOTA1OTA1OSJ9.a1emr46f-akrjq4_grLolS_tYkqhd18x4kgAVjlFpo0"
	v = validate(jwt, "5499acb59d16c1cb869005c3c72d346ade1a310f965ac9418be406d8561426ca5e327b6e0a1950803279e0fae1012a15eaaabf1fd488565eaffa447e0836a7d6", "1739059064")

	log.info(v)

main()
